(function(window) {
  var MozillaTaiwan = [
    {
      name: 'Alive',
      email: 'alive@mozilla.com',
      team: 'gaia',
      functional: 'free'
    },
    {
      name: 'Yuren',
      email: 'yurenju.mozilla@gmail.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'Arthur',
      email: 'arthur.chen@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'Gary',
      email: 'gchen@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'John',
      email: 'johu@mozilla.com',
      team: 'gaia',
      functional: 'media'
    },
    {
      name: 'Dominic',
      email: 'dkuo@mozilla.com',
      team: 'gaia',
      functional: 'media'
    },
    {
      name: 'George',
      email: 'gduan@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'Ian',
      email: 'iliu@mozilla.com',
      team: 'gaia',
      functional: 'productivity'
    },
    {
      name: 'Steve',
      email: 'schung@mozilla.com',
      team: 'gaia',
      functional: 'communications'
    },
    {
      name: 'Rex',
      email: 'rexboy@mozilla.com',
      team: 'gaia',
      functional: 'communications'
    },
    {
      name: 'Evan',
      email: 'evanxd@mozilla.com',
      team: 'gaia',
      functional: 'productivity'
    },
    {
      name: 'Rudy',
      email: 'rlu@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'Fred',
      email: 'gasolin@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'EJ',
      email: 'ejchen@mozilla.com',
      team: 'gaia',
      functional: ''
    },
    {
      name: 'Luke',
      email: 'lchang@mozilla.com',
      team: 'gaia',
      functional: ''
    },
    {
      name: 'Tzu-Lin',
      email: 'tzhuang@mozilla.com',
      team: 'gaia',
      functional: ''
    },
    {
      name: 'Greg',
      email: 'gweng@mozilla.com',
      team: 'gaia',
      functional: 'system-platform'
    },
    {
      name: 'Kanru',
      email: 'kchen@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Henry',
      email: 'hchang@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Vincent Chang',
      email: 'vchang@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Edgar',
      email: 'echen@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Aknow',
      email: 'szchen@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Yoshi',
      email: 'allstars.chh@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Jessica',
      email: 'jjong@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Dimi',
      email: 'dlee@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Shao-Hang',
      email: 'skao@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Chuck',
      email: 'chulee@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Gene',
      email: 'gene.lian@mozilla.com',
      team: 'gecko',
      functional: ['communications']
    },
    {
      name: 'John(Stone)',
      email: 'jshih@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Hsinyi',
      email: 'htsai@mozilla.com',
      team: 'gecko',
      functional: ['communications']
    },
    {
      name: 'ChiaHung',
      email: 'ctai@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    /* {
      name: 'Bevis',
      email: 'btseng@mozilla.com'
    }, */
    {
      name: 'Georgia',
      email: 'gwang@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Patrick',
      email: 'pwang@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Vicamo',
      email: 'vyang@mozilla.com',
      team: 'gecko',
      functional: 'telephony'
    },
    {
      name: 'Phoebe',
      email: 'phchang@mozilla.com',
      team: 'gecko',
      functional: 'recording'
    },
    {
      name: 'Peter',
      email: 'pchang@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Benjamin',
      email: 'bechen@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'SC',
      email: 'schien@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Steven',
      email: 'slee@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    /*{
      name: 'John Lin',
      email: 'jolin@mozilla.com',
      team: 'gecko',
      functional: ''
    },*/
    {
      name: 'Randy',
      email: 'rlin@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Shelly',
      email: 'slin@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Jerry',
      email: 'hshih@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Morris',
      email: 'mtseng@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'JW',
      email: 'jwwang@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Alfredo',
      email: 'ayang@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Marco',
      email: 'mchen@mozilla.com',
      team: 'gecko',
      functional: ['device']
    },
    {
      name: 'Eric',
      email: 'echou@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Gina',
      email: 'gyeh@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Ben',
      email: 'btian@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Bruce',
      email: 'brsun@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Alan',
      email: 'ahuang@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Shawn',
      email: 'shuang@mozilla.com',
      team: 'gecko',
      functional: ['telephony']
    },
    {
      name: 'Shawn Ku',
      email: 'sku@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Vincent Lin',
      email: 'vlin@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Vincent Liu',
      email: 'vliu@mozilla.com',
      team: 'gecko',
      functional: ['device']
    },
    {
      name: 'Viral',
      email: 'vwang@mozilla.com',
      team: 'gecko',
      functional: ['device']
    },
    {
      name: 'TingYuan',
      email: 'thuang@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Thinker',
      email: 'tlee@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'Cervantes',
      email: 'cyu@mozilla.com',
      team: 'gecko',
      functional: ''
    },
    {
      name: 'CJ',
      email: 'cku@mozilla.com',
      team: 'gecko',
      functional: ['recording']
    },
    {
      name: 'Tim',
      email: 'timdream@gmail.com',
      team: 'gaia:platform',
      functional: 'system-platform'
    },
    {
      name: 'Evelyn',
      email: 'ehung@mozilla.com',
      team: 'gaia:device',
      functional: ''
    },
    {
      name: 'Mike',
      email: 'mtsai@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Pecko',
      email: 'pchen@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Neo',
      email: 'nhsieh@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Helen',
      email: 'hhuang@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Juwei',
      email: 'jhuang@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Fang',
      email: 'fshih@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'Carrie',
      email: 'cawang@mozilla.com',
      team: 'ux',
      functional: ''
    },
    {
      name: 'William',
      email: 'whsu@mozilla.com',
      team: 'qa',
      functional: ['recording']
    },
    {
      name: 'Atsai',
      email: 'atsai@mozilla.com',
      team: 'qa',
      functional: ['performance']
    },
    {
      name: 'Walter',
      email: 'wachen@mozilla.com',
      team: 'qa',
      functional: ['telephony']
    },
    {
      name: 'Askeing',
      email: 'fyen@mozilla.com',
      team: 'qa',
      functional: ['system-platform']
    },
    {
      name: 'Enpei',
      email: 'echu@mozilla.com',
      team: 'qa',
      functional: ''
    },
    {
      name: 'Joe',
      email: 'jcheng@mozilla.com',
      team: 'pm',
      functional: ['communications', 'recording', 'device']
    },
    {
      name: 'Wayne',
      email: 'wchang@mozilla.com',
      team: 'pm',
      functional: ''
    },
    {
      name: 'Kevin',
      email: 'khu@mozilla.com',
      team: 'pm',
      functional: ['telephony']
    },
    {
      name: 'Ivan',
      email: 'itsay@mozilla.com',
      team: 'pm',
      functional: ['system-platform']
    },
    {
      name: 'Bruce Huang',
      email: 'bhuang@mozilla.com',
      team: 'pm',
      functional: ''
    },
    {
      name: 'Steven Yang',
      email: 'styang@mozilla.com',
      team: 'pm',
      functional: ''
    },
    {
      name: 'Francis Lee ',
      email: 'frlee@mozilla.com',
      team: 'pm',
      functional: ''
    }
  ];

  var App = {
    config: {
      start: '2013-07-15',
      end: moment().format('YYYY-MM-DD')
    },

    init: function app_init() {
      this._bindEvents();
      MozillaTaiwan.forEach(function(person) {
        new BZQuery(jQuery.extend({
          start: this.config.start,
          end: this.config.end
        }, person));
      }, this);
    },

    _bindEvents: function app__bindEvents() {
      var self = this;
      /* Date Picker */
      $('#dp').datepicker({
         format: "yyyy-mm-dd",
         autoclose: true
      }).on('changeDate', function(evt){
        if (evt.target.name == 'start') {
          self.config.start = evt.format('yyyy-mm-dd');
        } else if (evt.target.name == 'end') {
          self.config.end = evt.format('yyyy-mm-dd');
        }

        BZQuery.manager.forEach(function(person) {
          person.reload(self.config);
        });
      });

      /* Tab */
      $('#brh-tab').tab();
      $('#brh-tab a').click(function (evt) {
        var team = $(this).prop('href').split('#')[1];
        var type = $(this).data('type');
        evt.preventDefault();
        $(this).tab('show');
        BZQuery.manager.forEach(function(person) {
          person.filter(team, type);
        });
      });
    }
  };

  App.init();

}(this));